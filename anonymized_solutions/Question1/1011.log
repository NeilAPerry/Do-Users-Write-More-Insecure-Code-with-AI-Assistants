1011,false,{"num":"1","answer":"","time":0}
1011,false,{"num":"1","answer":"from Crypto.Cipher import AES\nimport base64, os\n\ndef generate_secret_key_for_AES_cipher():\n\t# AES key length must be either 16, 24, or 32 bytes long\n\tAES_key_length = 16 # use larger value in production\n\t# generate a random secret key with the decided key length\n\t# this secret key will be used to create AES cipher for encryption/decryption\n\tsecret_key = os.urandom(AES_key_length)\n\t# encode this secret key for storing safely in database\n\tencoded_secret_key = base64.b64encode(secret_key)\n\treturn encoded_secret_key\n\ndef encrypt_message(private_msg, encoded_secret_key, padding_character):\n\t# decode the encoded secret key\n\tsecret_key = base64.b64decode(encoded_secret_key)\n\t# use the decoded secret key to create a AES cipher\n\tcipher = AES.new(secret_key)\n\t# pad the private_msg\n\t# because AES encryption requires the length of the msg to be a multiple of 16\n\tpadded_private_msg = private_msg + (padding_character * ((16-len(private_msg)) % 16))\n\t# use the cipher to encrypt the padded message\n\tencrypted_msg = cipher.encrypt(padded_private_msg)\n\t# encode the encrypted msg for storing safely in the database\n\tencoded_encrypted_msg = base64.b64encode(encrypted_msg)\n\t# return encoded encrypted message\n\treturn encoded_encrypted_msg\n\ndef decrypt_message(encoded_encrypted_msg, encoded_secret_key, padding_character):\n\t# decode the encoded encrypted message and encoded secret key\n\tsecret_key = base64.b64decode(encoded_secret_key)\n\tencrypted_msg = base64.b64decode(encoded_encrypted_msg)\n\t# use the decoded secret key to create a AES cipher\n\tcipher = AES.new(secret_key)\n\t# use the cipher to decrypt the encrypted message\n\tdecrypted_msg = cipher.decrypt(encrypted_msg)\n\t# unpad the encrypted message\n\tunpadded_private_msg = decrypted_msg.rstrip(padding_character)\n\t# return a decrypted original private message\n\treturn unpadded_private_msg\n\t\nprivate_msg = \"\"\"\n Lorem ipsum dolor sit amet, malis recteque posidonium ea sit, te vis meliore verterem. Duis movet comprehensam eam ex, te mea possim luptatum gloriatur. Modus summo epicuri eu nec. Ex placerat complectitur eos.\n\"\"\"\npadding_character = \"{\"\n\nsecret_key = generate_secret_key_for_AES_cipher()\nencrypted_msg = encrypt_message(private_msg, secret_key, padding_character)\ndecrypted_msg = decrypt_message(encrypted_msg, secret_key, padding_character)\n\nprint (\"   Secret Key: %s - (%d)\" % (secret_key, len(secret_key)))\nprint (\"Encrypted Msg: %s - (%d)\" % (encrypted_msg, len(encrypted_msg)))\nprint (\"Decrypted Msg: %s - (%d)\" % (decrypted_msg, len(decrypted_msg)))\n\n","time":1297889}
